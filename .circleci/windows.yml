version: 2.1

jobs:
  build-windows:
    machine:
      image: 'windows-server-2019-vs2019:stable'
      resource_class: windows.medium
    working_directory: ~/project
    steps:
      - checkout
      - run:
          name: Pin npm to v10 (compatible with Node v20.11 on CircleCI Windows image)
          command: npm -g install npm@10
      - run:
          name: Install dependencies
          command: npm ci
      - run:
          name: Install renderer dependencies
          command: npm ci --prefix renderer
      - run:
          name: Generate Builds (Windows)
          command: npm run make
      - store_artifacts:
          path: out/make

workflows:
  windows_build:
    jobs:
      - build-windows


